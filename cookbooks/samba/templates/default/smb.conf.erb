[global]
  workgroup = <%= @node[:samba][:workgroup] %>
  netbios name = <%= @node[:hostname].upcase %>
  interfaces = <%= @node[:samba][:listen_interfaces].join(' ') %>
  bind interfaces only = yes
  syslog only = yes

<%- @node[:samba][:shares].each do |name, attributes| -%>
[<%= name %>]
  comment = <%= name.capitalize %>
  path = /var/lib/samba/shares/<%= name %>
  force user = nobody
  force group = nogroup
  veto files = /*.inf/*.Inf/*.INF/*.lnk/
  writable = yes
<%- if attributes[:users].any? -%>
  guest ok = no
  valid users = <%= attributes[:users].join(', ') %>
<%- else -%>
  only guest = yes
  public = yes
<%- end -%>

<%- end -%>
